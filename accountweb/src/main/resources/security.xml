<beans xmlns="http://www.springframework.org/schema/beans"  
	xmlns:security="http://www.springframework.org/schema/security"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/security
        http://www.springframework.org/schema/security/spring-security.xsd
        ">
    <security:http pattern="/favicon.ico*" security="none"/>
 	<security:http pattern="/skin-config.html*" security="none"/>
 	<security:http pattern="/index*" security="none"/>
	<security:http pattern="/static/**" security="none"/>
	<security:http pattern="/img/**" security="none"/>
	<security:http pattern="/fonts/**" security="none"/>
    <security:http pattern="/js/**" security="none"/>
    <security:http pattern="/css/**" security="none"/>
    <security:http pattern="/template/**" security="none"/>
    <security:http pattern="/Angular/**" security="none"/>
    <security:http pattern="/font-awesome/**" security="none"/>
    <security:http pattern="/druid/**" security="none"/>
    <security:http pattern="/demo/**" security="none"/>
    <security:http pattern="/taskApi/**" security="none"/>
    <security:http pattern="/transTypeAction/**" security="none"/>
    <security:http pattern="/agentDayBalanceAction/**" security="none"/>



 	<!--定义用户详细信息类，用于获取用户信息-->
    <bean id="userDetailService" class="cn.eeepay.boss.security.UserDetailsServiceImpl"/>

    <security:global-method-security pre-post-annotations="enabled"/>
    <!--认证管理器，实现用户认证-->
    <security:authentication-manager alias="authenticationManager">
         <security:authentication-provider user-service-ref='userDetailService'>
         	<security:password-encoder hash="md5">
        		<security:salt-source user-property="username"/>
        	</security:password-encoder>
        </security:authentication-provider>
    </security:authentication-manager>
   
    <security:http use-expressions="true">
    	<security:access-denied-handler error-page="/noRigth.do"/>
	    <!-- 登录页面不需要控制权限 -->
	    <security:intercept-url pattern="/login*.do*" access="permitAll"/>
        <!-- 访问所有页面都需要有USER权限 -->
        <!-- <security:intercept-url pattern="/**" access="ROLE_USER" /> -->
        <!-- 配置登录页面地址login-page、登录失败后的跳转地址authentication-failure-url -->
    	<security:form-login login-page='/login.do' login-processing-url="/perform_login.do" default-target-url="/welcome.do" authentication-failure-url='/login.do?error' />
        <!-- 登出功能 -->
        <security:logout logout-url="/logout.do" invalidate-session="true" logout-success-url="/login.do?logout"/>
        <security:session-management invalid-session-url="/login.do?expired" session-authentication-error-url="/login.do">
            <!-- <security:concurrency-control max-sessions="1" error-if-maximum-exceeded="false" expired-url="/login.do?otherlogin" session-registry-alias="sessionRegistry" /> -->
        </security:session-management>
        <!--添加自定义的过滤器
        <security:custom-filter ref="securityFilter" before="FILTER_SECURITY_INTERCEPTOR"/>
        -->
        <security:csrf request-matcher-ref="csrfSecurityRequestMatcher"/>
    </security:http>
    
    <bean id="csrfSecurityRequestMatcher" class="cn.eeepay.boss.security.CsrfSecurityRequestMatcher">
    	<property name="execludeUrls">
			<list>
				<value>/adjustAction/</value>
				<value>/chuAccountAction/importOutBillDetailFile.do</value>
				<value>/reportAction/findBatchesDetailList.do</value>
            </list>
    	</property>
	</bean>
</beans>