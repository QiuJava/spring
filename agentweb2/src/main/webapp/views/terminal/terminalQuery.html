<!-- 导航URL -->
<div class="row wrapper border-bottom white-bg page-heading">
	<div class="col-md-12">
		<ol class="breadcrumb">
			<li><a href="#/service/addService">主页</a></li>
			<li><a>机具管理</a></li>
			<li class="active"><strong>机具查询</strong></li>
		</ol>
	</div>
</div>

<script type="text/ng-template" id="updateActivityContent.html">
     <div class="modal-header">
									     <h4 class="modal-title" id="updateActivity">更改活动</h4>
									      </div>
									      <div class="modal-body" style="height: 100px;">

									        <form>
									          <div class="form-group">
									            <label class="col-sm-3 control-label">请选择更改的活动：</label>
												<div class="col-sm-4">
													<select chosen="{width:'100%'}" class="chosen-select" tabindex="4" ng-model="info.activityTypeNo"  ng-options="x.activityTypeNo as x.activityTypeName for x in activityTypes" required>
							            	         	<option value=""></option>
							                        </select>
												</div>
												<p>注:更改后实时生效</p>
									          </div>
									        </form>

									      </div>
									      <div class="modal-footer">
									        <button type="button" class="btn btn-primary" ng-click="updateActivityOk()">确定</button>
									        <button type="button" class="btn btn-default" ng-click="updateActivityClose()">取消</button>
									      </div>


</script>


<script type="text/ng-template" id="adminModalContent.html">
     <div class="modal-header">
									        <h4 class="modal-title" id="myModalLabel">机具下发</h4>
									      </div>
									      <div class="modal-body" style="height: 300px;">
									       
									        <form>
									          <div class="form-group">
									            <label class="col-sm-2 control-label">终端总数量：</label>
												<div class="col-sm-2">
													<p ng-bind="info.number"></p>
												</div>
									          </div>
									          <div class="form-group">
									            <label class="col-sm-3 control-label">代理商名称：</label>
												<div class="col-sm-4">
													<select chosen="{width:'100%'}" class="chosen-select" tabindex="4" ng-model="info.agentNo" ng-options="x.value as x.text for x in agent">
							            	         	<option value=""></option>
							                        </select>
												</div>
									          </div>
									        </form>
									       
									      </div>
									      <div class="modal-footer">
									        <button type="button" class="btn btn-default" ng-click="solutionModalClose()">关闭</button>
									        <button type="button" class="btn btn-primary" ng-click="solutionModalOk()">确定</button>
									      </div>
</script>
<script type="text/ng-template" id="adminModalContentBatch.html">
     <div class="modal-header">
									        <h4 class="modal-title" id="myModalLabel">机具下发</h4>
									      </div>
									      <div class="modal-body" style="height: 300px;">
									       
									        <form>
									          <div class="form-group">
									            <label class="col-sm-2 control-label">机具SN号：</label>
												<div class="col-sm-6">
													<input type="text" ng-change="snChange()" class="form-control" style="width:auto;display:inline-block;" ng-model="info.snStart1">-
													<input type="text" ng-change="snChange()" class="form-control" style="width:auto;display:inline-block;" ng-model="info.snEnd1">
												</div>
									          </div>
									          <div class="form-group">
									            <label class="col-sm-3 control-label">代理商名称：</label>
												<div class="col-sm-4">
													<select chosen="{width:'100%'}" class="chosen-select" tabindex="4" ng-model="info.agentNo" ng-options="x.value as x.text for x in agent">
							            	         	<option value=""></option>
							                        </select>
												</div>
									          </div>
									          <div class="form-group">
									            <label class="col-sm-3 control-label">下发机具数量：</label>
												<div class="col-sm-4">
													<span ng-bind="totalNum"></span> 台机具
													<span ng-show="errorMsg" style="color:red;">{{errorMsg}}</span>
												</div>
									          </div>
									        </form>
									       
									      </div>
									      <div class="modal-footer">
									        <button type="button" class="btn btn-default" ng-click="solutionModalClose()">关闭</button>
									        <button type="button" class="btn btn-primary" ng-click="solutionModalOk()">确定</button>
									      </div>
</script>

<script type="text/ng-template" id="adminPerAgentModalContentBatch.html">
	<div class="modal-header">
		<h4 class="modal-title" id="myPerAgentModalLabel">机具下发</h4>
	</div>
	<div class="modal-body" style="height: 300px;">

		<form class="form-horizontal">
		<div class="ibox-content">
			<div class="form-group">
				<label class="col-sm-2 control-label"><span style="color:red">*</span>机具SN号：</label>
				<div class="col-sm-10">
					<input type="text" ng-change="snChange()" class="form-control" style="width:auto;display:inline-block;" ng-model="info.snStart1">-
					<input type="text" ng-change="snChange()" class="form-control" style="width:auto;display:inline-block;" ng-model="info.snEnd1">
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-2 control-label">下发机具数量：</label>
				<div class="col-sm-10">
					<span ng-bind="totalNum"></span> 台机具
					<span ng-show="errorMsg" style="color:red;">{{errorMsg}}</span>
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-2 control-label"><span style="color:red">*</span>选择盟主：</label>
				<div class="col-sm-6">
					<select chosen="{width:'100%'}" class="chosen-select" data-placeholder="请选择需要下发的盟主或者大盟主" tabindex="3" ng-model="info.userCode" ng-options="x.value as x.text for x in pauser">
						<option value=""></option>
					</select>
				</div>
			</div>
		</div>
		</form>

	</div>
	<div class="modal-footer">
		<button type="button" class="btn btn-default" ng-click="solutionModalClose()">关闭</button>
		<button type="button" class="btn btn-primary" ng-click="solutionModalOk()">确定</button>
	</div>
</script>

<script type="text/ng-template" id="adminPerAgentModalContentBatchOne.html">
	<div class="modal-header">
		<h4 class="modal-title" id="myPerAgentModalLabel">机具下发</h4>
	</div>
	<div class="modal-body" style="height: 300px;">

		<form>

			<div class="form-group">
				<label class="col-sm-2 control-label">终端总数量：</label>
				<div class="col-sm-2">
					<p ng-bind="info.number"></p>
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-2 control-label"><span style="color:red">*</span>选择盟主：</label>
				<div class="col-sm-4">
					<select chosen="{width:'100%'}" class="chosen-select" data-placeholder="请选择需要下发的盟主或者大盟主" tabindex="4" ng-model="info.userCode" ng-options="x.value as x.text for x in pauser">
						<option value=""></option>
					</select>
				</div>
			</div>

		</form>

	</div>
	<div class="modal-footer">
		<button type="button" class="btn btn-default" ng-click="solutionModalClose()">关闭</button>
		<button type="button" class="btn btn-primary" ng-click="solutionModalOk()">确定</button>
	</div>
</script>



<!-- 主要内容 -->
<div class="wrapper wrapper-content animated fadeIn" ng-app
	ng-controller="terminalQueryCtrl">
	<div id="updateActivityResultButchModel" class="modal fade" tabindex="3"
         role="dialog">
        <form class="form-horizontal" id="form2">
            <div class="modal-dialog" style="height: 400px; width: 600px">
                <div class="modal-content" style="height: 600px; width: 600px">
                    <div class="modal-body">
                        <div class="ibox-content">
                            <div class="form-group">
                                <label class="col-sm-3 control-label" style="text-align:left;">批量更改活动已完成</label>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label" style="text-align:left;">成功更改：<ng-cell-text style="color: red;">{{successCount}}</ng-cell-text>台</label>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label" style="text-align:left;">更改失败：<ng-cell-text style="color: red;">{{errorCount}}</ng-cell-text>台</label>
                            </div>
                            <div class="panel-body ibox float-e-margins">
                                <label class="col-sm-3 control-label" style="text-align:left;"></label>
                                <div class="ibox-content">
                                    <div class="gridStyle" ui-grid="updateActivityResultButchGrid" style="height: 300px;"  ui-grid-pinning ui-grid-resize-columns></div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group control-label">
                            <label class="col-sm-2 control-label"></label>
                            <div class="col-sm-6">
                                <button class="btn btn-primary " type="button" ng-click='confirmButchModel()'>确定</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>


	<form class="form-horizontal" id="form1">
			<div class="row">
				<div class="col-lg-12">
					<div class="">
						<div class="panel-body ibox float-e-margins">
							<div class="ibox-title">
								<h5>机具信息多条列表查询</h5>
							</div>
							<div class="ibox-content">
								<div class="form-group">
										<!-- 228tgh -->
<!-- 									<label class="col-sm-2 control-label">机具SN号：</label> -->
<!-- 									<div class="col-sm-2"> -->
<!-- 										<input type="text" class="form-control" name="accountNo" ng-model="info.sn"> -->
<!-- 									</div> -->
									<label class="col-sm-2 control-label">机具SN号：</label>
									<div class="col-sm-6">
										<input type="text" class="form-control" style="width:auto;display:inline-block;" ng-model="info.snStart">-
										<input type="text" class="form-control" style="width:auto;display:inline-block;" ng-model="info.snEnd">
									</div>
									<label class="col-sm-2 control-label">硬件产品种类：</label>
									<div class="col-sm-2">
										<select class="form-control" ng-model="info.type" ng-options="x.hpId as x.typeName for x in termianlTypes"/>
									</div>
								</div>
								<div class="form-group">
									<label class="col-sm-2 control-label">机具状态：</label>
									<div class="col-sm-2">
										<select class="form-control" ng-model="info.openStatus" ng-options="x.value as x.text for x in terminalStates"/>
									</div>
									<!--<label class="col-sm-2 control-label">所属组织：</label>
									<div class="col-sm-2"  ng-show="!showSelect">
										<select chosen="{width:'100%'}" class="chosen-select form-control"  ng-model="info.teamName"
												ng-options="x.text as x.text for x in merTeams">
										</select>
									</div>-->
<!--
									<div class="col-sm-2 checkbox" ng-show="showSelect"><p ng-bind="baseInfo.merTeamId | formatDropping:merTeams"></p></div>
-->									<label class="col-sm-2 control-label">所属组织：</label>
									<div class="col-sm-2">
										<select class="form-control" ng-model="info.teamName" ng-options="x.value as x.text for x in merTeams"/>
									</div>
								</div>
								<div class="form-group">
									<label class="col-sm-2 control-label">商户名称/编号：</label>
									<div class="col-sm-2">
										<input type="text" class="form-control" name="accountNo" ng-model="info.merchantName">
									</div>
									<label class="col-sm-2 control-label">所分配代理商名称：</label>
									<div class="col-sm-2">
										<!-- tgh227 -->
										<!-- <input type="text" class="form-control" name="accountNo" ng-model="info.agentName"> -->
										<select chosen="{width:'100%'}" class="chosen-select" style=" width: 200px;tabindex="4" ng-model="info.agentName" ng-options="x.value as x.text for x in agent"  ng-change="agt_ch()">
						            	         	<option value=""></option>
						                        </select>
									</div>
									<label class="col-sm-2 control-label">包含下级：</label>
									<div class="col-sm-2">
										<select class="form-control" ng-disabled="dtr" ng-model="info.bool" ng-options="x.value as x.text for x in bools"/>
									</div>
								</div>
								<div class="form-group">
									<!--<label class="col-sm-2 control-label">PSAM编号：</label>-->
									<!--<div class="col-sm-6">-->
										<!--<input type="text" class="form-control" style="width:auto;display:inline-block;" name="accountNo" ng-model="info.psamNo">- -->
										<!--<input type="text" class="form-control" style="width:auto;display:inline-block;" name="accountNo" ng-model="info.psamNo1">-->
									<!--</div>-->
									<label class="col-sm-2 control-label">机具活动类型：</label>
									<div class="col-sm-2">
										<select class="form-control" ng-model="info.activityType" ng-options="x.value as x.text for x in activityTypes"/>
									</div>
									<label class="col-sm-2 control-label">欢乐返子类型:</label>
									<div class="col-sm-2">
										<select class="form-control" ng-model="info.activityTypeNo" ng-options="x.value as x.text for x in typeNos"/>
									</div>
									<label class="col-sm-2 control-label" ng-show="agentType==11">所属盟主编号：</label>
									<div class="col-sm-2" ng-show="agentType==11">
										<!-- tgh227 -->
										<!-- <input type="text" class="form-control" name="accountNo" ng-model="info.agentName"> -->
										<select chosen="{width:'100%'}" class="chosen-select" style=" width: 200px;tabindex="4" ng-model="info.userCode" ng-options="x.value as x.text for x in userCodes"  ng-change="agt_ch()">
										<option value=""></option>
										</select>
									</div>
									<!--<label class="col-sm-2 control-label">所属盟主姓名：</label>
									<div class="col-sm-2">
										&lt;!&ndash; tgh227 &ndash;&gt;
										&lt;!&ndash; <input type="text" class="form-control" name="accountNo" ng-model="info.agentName"> &ndash;&gt;
										<select chosen="{width:'100%'}" class="chosen-select" style=" width: 200px;tabindex="4" ng-model="info.realName" ng-options="x.value as x.text for x in userNames"  ng-change="agt_ch()">
										<option value=""></option>
										</select>
									</div>-->

								</div>
								<div class="form-group">
									<label class="col-sm-2 control-label">接收日期：</label>
									<div class="col-sm-5">

										<input id="d5221" class="form-control" type="datetime" ng-model="info.startReceiptdate" onchange=""  style="width:auto;display:inline-block;"
											   onFocus="var d5222=$dp.$('d5222');WdatePicker({skin:'whyGreen',dateFmt:'yyyy-MM-dd HH:mm:ss',changed:verifyTimeFun(1,'#d5221','#d5222',31,isVerifyTime,setStartReceiptdate,setEndReceiptdate),onpicked:function(){d5222.focus();},maxDate:'#F{$dp.$D(\'d5222\')||\'%y-%M-%d\'}'})"/>
										~
										<input id="d5222" class="form-control" type="datetime"  ng-model="info.endReceiptdate" onchange=""  style="width:auto;display:inline-block;"
											   onFocus="WdatePicker({skin:'whyGreen',dateFmt: 'yyyy-MM-dd HH:mm:ss',changed:verifyTimeFun(2,'#d5221','#d5222',31,isVerifyTime,setStartReceiptdate,setEndReceiptdate),minDate:'#F{$dp.$D(\'d5221\')}',maxDate:'%y-%M-%d 23:59:59'})"/>
									</div>
								</div>
									<div class="form-group">
									<label class="col-sm-2 control-label">下发日期：</label>
									<div class="col-sm-5">

										<input id="d5223" class="form-control" type="datetime" ng-model="info.startDowndate" onchange=""  style="width:auto;display:inline-block;"
											   onFocus="var d5222=$dp.$('d5222');WdatePicker({skin:'whyGreen',dateFmt:'yyyy-MM-dd HH:mm:ss',changed:verifyTimeFun(1,'#d5223','#d5224',31,isVerifyTime,setStartDowndate,setEndDowndate),onpicked:function(){d5222.focus();},maxDate:'#F{$dp.$D(\'d5222\')||\'%y-%M-%d\'}'})"/>
										~
										<input id="d5224" class="form-control" type="datetime"  ng-model="info.endDowndate" onchange=""  style="width:auto;display:inline-block;"
											   onFocus="WdatePicker({skin:'whyGreen',dateFmt: 'yyyy-MM-dd HH:mm:ss',changed:verifyTimeFun(2,'#d5223','#d5224',31,isVerifyTime,setStartDowndate,setEndDowndate),minDate:'#F{$dp.$D(\'d5221\')}',maxDate:'%y-%M-%d 23:59:59'})"/>
									</div>
								</div>
								<div class="form-group">
									<div class="col-lg-12">
										<label class="col-sm-2 control-label"></label>
										<button class="btn btn-primary6 btn-mr20" type="button" ng-click="selectInfo()"
											id="btnSubmit">查询</button>
										
										<button class="btn btn-primary3" type="button" ng-click="clear()"
											id="btnSubmit2">清空</button>

										<button class="btn btn-primary7" type="button" ng-click="exportInfo()"
												id="btnSubmit3">导出</button>
									</div>
								</div>
							</div>
						</div>
						
						
						<div class="panel-body ibox float-e-margins">
								<div class="ibox-title">
									<h5>机具信息列表</h5>
                                    </div>
                                    <div style="text-align:right; padding:0 20px; background:#fff">
										<button class="btn btn-new" type="button"
												ng-click="updateActivityBatch()">更改活动</button>
										<button class="btn btn-new" type="button" ng-show="(hasPermit('recoveryTerminal') && (agentType != 11 || loginUserType==1))"
												ng-click="recoveryTerminal()">机具回收</button>
                                    <button class="btn btn-new " type="button" ng-show="hasPermit('sendTerminal')  && levelStatus != 1"
											ng-click="sendTerminalBatch()">批量下发</button>
                                    <button class="btn btn-new " type="button" ng-show="hasPermit('sendTerminal') && levelStatus != 1"
											ng-click="sendTerminal()">机具下发</button>

                                            </div>

							</div>
								<div class="ibox-content">
<!-- 									<table id="tables" width="100%" datatable="" dt-instance="datatablesObject" dt-options="dtOptions" dt-columns="dtColumns" class="row-border hover"></table> -->
									 <div ui-grid="gridOptions" class="grid" ui-grid-pagination ui-grid-exporter ui-grid-resize-columns ui-grid-selection ui-grid-pinning ></div>
								</div>
								<div style="height: 50px"></div>
							</div>
					</div>
				</div>
	</form>
</div>